const { parseDateTime, formatMoment } = require('../../datetime');

module.exports = ([date, duration, units]) => {
  if (date == null) {
    return null;
  }
  const parsedDate = parseDateTime(date);
  if (!parsedDate.isValid()) {
    return null;
  }
  if (typeof duration === 'number'
      && Number.isFinite(duration)
      && (units == null || typeof units === 'string')) {
    return formatMoment(parsedDate.subtract(duration, units));
  }
  return formatMoment(parsedDate);
};
