const average = require('./AVERAGE.runtime');

const variance = (array) => {
  const avg = average([array]);
  if (typeof avg === 'number' && Number.isFinite(avg)) {
    const quadSum = array.reduce((total, item) => total + ((item - avg) ** 2), 0);
    return (array.length === 1) ? 0 : quadSum / (array.length - 1);
  }
  return null;
};

module.exports = ([array]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  const validArray = array.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  if (validArray.length) {
    const result = variance(validArray);
    return Number.isFinite(result) ? result : null;
  }
  return null;
};
