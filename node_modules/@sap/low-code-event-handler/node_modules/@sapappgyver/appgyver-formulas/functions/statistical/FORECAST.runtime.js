const { linearRegression } = require('../../utils/math');

module.exports = ([x, array1, array2]) => {
  if (!Array.isArray(array1) || !Array.isArray(array2)) {
    return null;
  }
  const yValidArray = array1.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  const xValidArray = array2.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  if (xValidArray.length !== yValidArray.length || !xValidArray.length) {
    return null;
  }
  const { slope, intercept } = linearRegression(yValidArray, xValidArray);
  if (typeof slope === 'number' && Number.isFinite(slope)
      && typeof intercept === 'number' && Number.isFinite(intercept)) {
    return intercept + (slope * x);
  }
  return null;
};
