const average = require('./AVERAGE.runtime');

module.exports = ([value, array, isAscending]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  if (!(typeof value === 'number' && Number.isFinite(value))) {
    return null;
  }
  const validArray = array.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  const sortedArr = [...validArray].sort((a, b) => {
    if (a > b) return 1;
    if (a < b) return -1;
    return 0;
  });
  if (!isAscending) {
    sortedArr.reverse();
  }
  const indexes = sortedArr.reduce((total, item, index) => {
    if (item === value) {
      total.push(index + 1);
    }
    return total;
  }, []);
  if (!indexes.length) {
    return null;
  }
  const avgIndex = average([indexes]);
  return avgIndex;
};
