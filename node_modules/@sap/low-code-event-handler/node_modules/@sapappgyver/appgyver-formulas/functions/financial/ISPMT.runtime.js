const { ISPMT } = require('../../financial');

module.exports = ([rate, period, periods, present]) => {
  if (rate == null || period == null || periods == null || present == null) {
    return null;
  }

  if (typeof rate !== 'number'
      || !Number.isFinite(rate)
      || typeof period !== 'number'
      || !Number.isFinite(period)
      || typeof periods !== 'number'
      || !Number.isFinite(periods)
      || typeof present !== 'number'
      || !Number.isFinite(present)
  ) {
    return null;
  }

  const result = ISPMT(rate, period, periods, present);
  return Number.isFinite(result) ? result : null;
};
