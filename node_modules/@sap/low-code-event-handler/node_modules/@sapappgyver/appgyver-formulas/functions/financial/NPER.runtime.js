const { NPER } = require('../../financial');

module.exports = ([rate, amount, present, future, isOnBeginning]) => {
  if (rate == null || amount == null || present === null) {
    return null;
  }
  const futureSaved = future || 0;
  const isOnBeginningSaved = isOnBeginning || false;

  if (typeof rate !== 'number'
      || !Number.isFinite(rate)
      || typeof amount !== 'number'
      || !Number.isFinite(amount)
      || typeof present !== 'number'
      || !Number.isFinite(present)
      || typeof futureSaved !== 'number'
      || !Number.isFinite(futureSaved)
      || typeof isOnBeginningSaved !== 'boolean'
  ) {
    return null;
  }

  const result = NPER(rate, amount, present, futureSaved, isOnBeginningSaved);
  return Number.isFinite(result) ? result : null;
};
