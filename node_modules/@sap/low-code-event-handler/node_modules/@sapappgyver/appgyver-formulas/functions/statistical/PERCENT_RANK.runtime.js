const sortArray = require('../list/SORT.runtime');

module.exports = ([array, num]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  const validArray = array.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  const { length } = validArray;
  if (!length) {
    return null;
  }
  const sortArr = sortArray([validArray, 'desk']);
  const per = index => index / (length - 1);
  if (sortArr.indexOf(num) !== -1) {
    return sortArr.indexOf(num) / (length - 1);
  }
  if (sortArr[0] < num && num < sortArr[length - 1]) {
    let i = 0;
    while (i < length - 1) {
      if (sortArr[i] < num && num < sortArr[i + 1]) {
        return per(i) + (num - sortArr[i])
            / (sortArr[i + 1] - sortArr[i]) * (per(i + 1) - per(i));
      }
      // eslint-disable-next-line no-plusplus
      i++;
    }
  }
  return null;
};
