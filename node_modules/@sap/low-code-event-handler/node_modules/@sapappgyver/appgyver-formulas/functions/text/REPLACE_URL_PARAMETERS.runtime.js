const queryString = require('query-string');
const { formats: { url: urlFormat } } = require('../../formatting');

module.exports = ([baseUrl, params]) => {
  if (baseUrl == null || params == null) {
    return null;
  }
  if (typeof baseUrl !== 'string' || typeof params !== 'object') {
    return null;
  }
  if (!urlFormat.matches(baseUrl)) {
    return null;
  }
  let baseUrlFixed = baseUrl.split('?')[0];
  if (baseUrlFixed[baseUrlFixed.length - 1] !== '/') {
    baseUrlFixed += '/';
  }
  const query = queryString.stringify(params);
  return query ? `${baseUrlFixed}?${query}` : baseUrlFixed;
};
