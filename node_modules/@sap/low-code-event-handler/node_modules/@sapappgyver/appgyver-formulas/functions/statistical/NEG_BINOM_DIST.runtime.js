const combin = require('../math/COMBIN.runtime');

module.exports = ([failures, success, prob]) => {
  if (typeof failures === 'number' && Number.isFinite(failures)
    && typeof success === 'number' && Number.isFinite(success)
    && typeof prob === 'number' && Number.isFinite(prob)) {
    if (failures < 1 || success < 0 || (prob < 0 && prob > 1)) {
      return null;
    }
    const intFailures = Math.trunc(failures);
    const intSuccess = Math.trunc(success);
    const combination = combin([intFailures + intSuccess - 1, intSuccess]);
    return combination * (prob ** intFailures) * ((1 - prob) ** intSuccess);
  }
  return null;
};
