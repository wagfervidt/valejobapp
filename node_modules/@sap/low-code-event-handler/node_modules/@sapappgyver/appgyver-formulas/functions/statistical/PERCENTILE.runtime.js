const percentile = (arr, perc) => {
  if (!arr.length) {
    return null;
  }
  const sortedArr = [...arr].sort((a, b) => {
    if (a > b) return 1;
    if (a < b) return -1;

    return 0;
  });
  const index = perc * (sortedArr.length - 1);
  if (Math.floor(index) === index) {
    return sortedArr[index];
  }
  const i = Math.floor(index);
  const fraction = index - i;
  return sortedArr[i] + (sortedArr[i + 1] - sortedArr[i]) * fraction;
};

module.exports = ([array, percent]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  if (!(typeof percent === 'number' && Number.isFinite(percent))) {
    return null;
  }
  if (percent > 1 || percent < 0) {
    return null;
  }
  const validArray = array.filter(item => (typeof item === 'number' && Number.isFinite(item)));
  const result = percentile(validArray, percent);
  return Number.isFinite(result) ? result : null;
};
