module.exports = ([array, index, setter]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  if (typeof index !== 'number' || !Number.isFinite(index) || typeof setter !== 'function') {
    return array;
  }
  const newArray = array.slice();
  const setIndex = Math.max(0, index < 0 ? array.length + index : index);
  for (let i = array.length; i < setIndex - 1; i += 1) {
    // Fill undefined to new slots
    newArray[i] = undefined;
  }
  // Set at the given index
  const newItem = setter(array[setIndex], setIndex);
  newArray[setIndex] = newItem;
  return newArray;
};
