const sortArray = require('../list/SORT.runtime');
const average = require('./AVERAGE.runtime');

module.exports = ([array, num]) => {
  if (!Array.isArray(array)) {
    return null;
  }
  if (Number.isFinite(num) || typeof num === 'number') {
    if (num >= 1 || num < 0) {
      return null;
    }
    const validArray = array.filter(item => (typeof item === 'number' && Number.isFinite(item)));
    const { length } = validArray;
    if (length) {
      const sortValidArray = sortArray([validArray, 'asc']);
      const prop = Math.floor(length * num / 2);
      const sliceArray = sortValidArray.slice(prop, length - prop);
      return average([sliceArray]);
    }
  }
  return null;
};
